# История изменений (Changelog)

Все значимые изменения этого проекта задокументированы в этом файле.

## [1.0.1] - 2026-02-21

### Добавлено
- **Заморозка времени при выходе с сервера**: Когда игрок выходит с сервера, его накопленное время сохраняется, но перестаёт накапливаться (устанавливается флаг `IsActive = false`)
- **Заморозка времени в спектаторах**: Когда игрок переходит в наблюдатели, накопление времени останавливается
- **Окно возврата 2 минуты**: Игрок, покинувший сервер, имеет 2 минуты (настраивается через `ReturnWindowSeconds`) чтобы вернуться. Если он вернётся вовремя — накопленное время сохранится. Если нет — время сбрасывается
- **Проверка регистрации в ЛК**: Перед выдачей награды плагин проверяет, есть ли игрок в базе данных личного кабинета (таблица `lk`). Если игрока нет в базе — награда не выдаётся
- **Секундный таймер накопления**: Заменён 10-секундный глобальный таймер на 1-секундный индивидуальный. Теперь время накапливается каждую секунду для каждого активного игрока

### Изменено
- Обновлена версия плагина до 1.0.1
- Добавлен новый параметр конфигурации `ReturnWindowSeconds` (по умолчанию 120 секунд)
- Переработана структура данных игроков: добавлен класс `PlayerTimeData` с полями `AccumulatedSeconds`, `IsActive`, `DisconnectTime`, `LastBonusTime`, `JoinTime`
- Добавлен новый обработчик событий `EventPlayerTeam` для отслеживания перехода игроков в спектаторы

### Технические детали
- Таймер работает каждую 1 секунду (`AddTimer(1.0f, SecondTimerCallback, TimerFlags.REPEAT)`)
- Логика проверки ЛК: `SELECT id FROM lk WHERE auth = @auth` перед `UPDATE lk SET cash = cash + @amount WHERE auth = @auth`
- Логирование событий заморозки/разморозки времени в файле логов

## [1.0.0] - 2026-02-20

### Добавлено
- Первая версия плагина
- Автоматическое начисление бонуса игрокам за время игры
- Интеграция с MySQL базой данных
- Поддержка мультиязычности (ru, en, uk)
- Настраиваемый интервал и сумма бонуса
- Логирование операций
- Исключение ботов и HLTV из системы бонусов

### Параметры конфигурации (v1.0.0)
- `BonusIntervalSeconds`: 600 (интервал в секундах)
- `BonusAmount`: 1 (сумма бонуса)
- `EnableLogging`: true
- `Language`: ru
